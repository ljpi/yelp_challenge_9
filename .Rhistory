#natural gas ppi
acf(ppinatgas2$residuals, lag.max = 100)
pacf(ppinatgas2$residuals, lag.max = 100)
#CUSUM for coal usage
plot(efp(coal.mod$res~1, type = "Rec-CUSUM"),main="CUSUM coal usage")
#CUSUM for PPI coal
plot(efp(arima_ppi_coal$res~1, type = "Rec-CUSUM"), main="CUSUM PPI coal")
#CUSUM for natural gas usage
plot(efp(armanguse$res~1, type = "Rec-CUSUM"),main="CUSUM natural gas usage")
#CUSUM for PPI natural gas
#quartz()
plot(efp(ppinatgas2$res~1, type = "Rec-CUSUM"),main="CUSUM PPI natural gas")
#Structural break yes it's gonna be a issue for forecast
res_ppi_ng=recresid(ppinatgas2$res~1,col="skyblue3")
plot(res_ppi_ng, pch=16,ylab="Recursive Residuals", main="Recursive Residuals PPI natural gas",col="skyblue3")
abline(h=0, col="red")
res_ppi_c=recresid(arima_ppi_coal$res~1)
plot(res_ppi_c, pch=16,ylab="Recursive Residuals",main="Recursive Residuals PPI coal",col="skyblue3")
abline(h=0,col="red")
res_coal_u=recresid(armacoaluse$res~1)
plot(res_coal_u, pch=16,ylab="Recursive Residuals", main="Recursive Residuals Coal Usage",col="skyblue3")
abline(h=0,col="red")#wuuuuuut?hetero? pretty disperse is good can standardize everything and look at the z score >2 nooo
#STANDR ORIGINAL SERIES FINDING Z SCORE SO FIT STAND MODEL and look at residuals
res_ng_u=recresid(armanguse$res~1)
plot(res_ng_u, pch=16,ylab="Recursive Residuals", main="Recursive Residuals Natural Gas Usage",col="skyblue3")
abline(h=0,col="red")
Box.test(ts.natgas.use, lag = 1, type = "Box-Pierce", fitdf = 0)
Box.test(ts.natgas.use, lag = 1, type = "Ljung-Box", fitdf = 0)
Box.test(ts.coal.use, lag = 1, type = "Box-Pierce", fitdf = 0)
Box.test(ts.coal.use, lag = 1, type = "Ljung-Box", fitdf = 0)
Box.test(ppi.natgas, lag = 1, type = "Box-Pierce", fitdf = 0)
Box.test(ppi.natgas, lag = 1, type = "Ljung-Box", fitdf = 0)
Box.test(ppi.coal, lag = 1, type = "Box-Pierce", fitdf = 0)
Box.test(ppi.coal, lag = 1, type = "Ljung-Box", fitdf = 0)
#is this what she asking for? MAPE ERROR METRICS ETC
forecast(armacoaluse,h=12)
forecast(arima_ppi_coal,h=12)
forecast(armanguse,h=12)
forecast(ppinatgas2,h=12)
plot(forecast(armacoaluse,h=12))
plot(forecast(arima_ppi_coal,h=12))
plot(forecast(armanguse,h=12))
plot(forecast(ppinatgas2,h=12))
## VAR MODEL
#create combined data set
usage_combined = cbind(ts.coal.use,ts.natgas.use)
#create a model selection process
select = VARselect(usage_combined, lag.max = 12, type = c("const", "trend", "both", "none"),
season = NULL, exogen = NULL)
vm = VAR(usage_combined,p=select$selection[1])
plot(vm)
knitr::opts_chunk$set(echo = TRUE)
library('vars')
library('readxl')
library('Quandl')
library('tseries')
library("forecast")
library("quantmod")
library("xts")
library("tis")
library("moments")
library('stats')
library("strucchange")
#importing data for coal and natural gas usage
xd <- read.csv('https://ljpi.github.io/Net_generation_for_all_sectors_monthly.csv', header = TRUE, skip = 4)
xd[,1] #dates show that data is in reverse order. The first date is Jan 2001 which appears last, and the last date in the ts is Nov 2016
coal_mwh <- rev(xd[,3])
natgas_mwh <- rev(xd[,4])
total_mwh <- rev(xd[,2])
head(xd[,1])
xd[c(1,length(xd[,1])),1]  #We will use Monthly from Jan-01 to Nov-16
ts.coal.use<- ts(coal_mwh, start = c(2001,2), end = c(2016,11), frequency = 12)
ts.natgas.use<- ts(natgas_mwh, start = c(2001,2), end = c(2016, 11), frequency = 12)
length(ts.natgas.use)
length(ts.coal.use)
mape <- function(y, yhat){
mean(abs((y - yhat)/y))
}
#Natural Gas and Coal PPI
getSymbols(c('WPU0531','WPU051'), src = 'FRED')
ppi.natgas <- ts(WPU0531['2001-01-01::2016-11-01'], start = 2001, frequency = 12)
ppi.coal <- ts(WPU051['2001-01-01::2016-11-01'], start = 2001, frequency = 12)
#we make the ppis covariance stationary
diff_coal_ppi<-diff(ppi.coal)
diff_ppinatgas<-diff(ppi.natgas)
plot(diff_ppinatgas, col = 'green', main = "Energy Price Indeces", ylab = "Index, 1982 = 100")
lines(diff_coal_ppi, col = 'orange')
legend('topright', legend = c( 'PPI Coal', 'PPI Natural Gas'), lty = c(1,1), col = c('orange','green'))
#creatime time var
timex<-seq(2001.1,2016.9, by = 1/12)
par(mfrow=c(1,1))
#plot(timex,ts.natgas.use, xlim = c(2001, 2017),
#     ylim = c(0, max(ts.total.use)), ylab = "Megawatthours (thousands)",
#     main = 'General Energy Usage',col="green", type="l",lwd=2)
#lines(timex,ts.coal.use, col = 'orange', lwd = 2)
#legend('topright', legend = c( "Natural Gas Usage",'Coal Usage'), lty = c(1,1), col = c("green",'orange'))
#change the axis
#make time var for x axis using seq()
#check length
#natural gas#
par(mfrow=c(2,1))
plot(acf(ts.natgas.use, lag.max = 100), main="Natural Gas Usage") # Obvious Seasonality. #Peaks at 12 months (winter). Troughs at 6 months (summer).
axis(1, at = seq(0,8, by = .5), labels = FALSE)
plot(pacf(ts.natgas.use, lag.max = 100))#plot() and main=
axis(1, at = seq(0,8, by = .5), labels = FALSE) #partial correlations at lag 1 and lag 12 are highly significant. Decays to zero slowly thereafter.
##workout the lags USE forecast Pacf Acf  but package starts a lag of 1
#coal use#
acf(ts.coal.use, lag.max = 100) # Obvious Seasonality. #Peaks at 6 and 12 months. Troughs during fall and spring. Still significant positive corr.
axis(1, at = seq(0,8, by = .5), labels = FALSE)
pacf(ts.coal.use, lag.max = 100) #lag 1 looks equal to acf(lag 1).
axis(1, at = seq(0,8, by = .5), labels = FALSE) #partial correlations at lag 1 and lag 12 are highly significant. Decays to zero slowly thereafter.
#where can i add the title
acf(diff_coal_ppi, lag.max = 100)
pacf(diff_coal_ppi, lag.max = 100) #No significant values. Goes to zero. Not an AR. All regressions after lag =1 can be sufficiently explained by the correlation at lag 1.
acf(diff_ppinatgas, lag.max=100)
pacf(diff_ppinatgas, lag.max=100)
#S-AR(1). PACF cuts off after lag=1 (which has a value resembling the ACF(1) value), then spikes a seasons.
#Model building
t <- seq(2001.08, by=1/12,length = 190)
t2=t^2
t3=t^3
t4=t^4
sint = sin(1*pi*t)
cost=cos(1*pi*t)
#Model buiding for PPI natural gas
ppi_natgas_mod <- tslm(diff_ppinatgas~t+t2+season)
summary(ppi_natgas_mod)
#or
#ARIMA
ppinatgas2 <- auto.arima(diff(ppi.natgas))#how did we choose the lags
#ppinatgas2<-auto.arima(ppi.natgas)
summary(ppinatgas2)
plot(ppi_natgas_mod$fitted.values,lty = 1, col = 'red', lwd = 1.5,main="PPI Natural Gas", ylab="Price",ylim=c(-60,50))#ylim to exp axis put vector that has range of values
lines(fitted(ppinatgas2),lty = 1, col = 'skyblue3', lwd = 1.5)
legend('topright', legend = c( 'ppinatgas2', 'ppi_natgas_mod'), lty = c(1,1), col = c('red','skyblue3'))
#rescale axis
#Model selection for PPI_coal
diff_coal_ppi<-diff(ppi.coal)
ppi_coal_mod <- tslm(diff_coal_ppi~t+t2+season)
summary(ppi_coal_mod)
#ARIMA  ##try AUTOARIMA
arima_ppi_coal = auto.arima(diff_coal_ppi)
summary(arima_ppi_coal)
#plot
plot(fitted(ppi_coal_mod), col="red",ylim=c(-5,5))
lines(fitted(arima_ppi_coal), col = 'skyblue3')
legend('bottomright', legend = c( 'ppinatgas2', 'ppi_natgas_mod'), lty = c(1,1), col = c('red','skyblue3'))
#Model selection for Natural Gas usage
#tslm
ng.usage.model <- tslm(ts.natgas.use~t+t2+season)
summary(ng.usage.model)
#or ARIMA
armanguse = auto.arima(ts.natgas.use)
summary(armanguse) #best fit
#plot
plot(ng.usage.model$fitted.values, col="skyblue3",main="Natural Gas Usage",ylim=c(40000,160000))
lines(fitted(armanguse), col = 'red')
legend('bottomright', legend = c( 'armanguse', 'ng.usage.model'), lty = c(1,1), col = c('red','skyblue3'))
#Competing models for Coal usage
#tslm
coal.mod <- tslm(ts.coal.use~t+t3+season)
summary(coal.mod)
#or
#ARIMA(1,0,1) model
armacoaluse= auto.arima(ts.coal.use)
summary(armacoaluse)
#plot
plot(ts.coal.use, col="skyblue3",ylim=c(60000,190000))
lines(fitted(armacoaluse), col = 'red')
legend('topright', legend = c( 'armancoaluse', 'ts.coal.use'), lty = c(1,1), col = c('red','skyblue3'))
#We compare to possible models to predict natural gas usage
AIC_armanguse<-AIC(armanguse) #preferred model
BIC_armanguse<-BIC(armanguse)
AIC_ng.usage.model<-AIC(ng.usage.model)
BIC_ng.usage.model<-BIC(ng.usage.model)
NATGAS_USAGE_METRICS<-c(AIC_armanguse,BIC_armanguse,AIC_ng.usage.model,BIC_ng.usage.model)
#stargazer(NATGAS_USAGE_METRICS,title = "BIC and AIC TESTS", header = FALSE, type = "latex", summary = FALSE, rownames = TRUE, colnames = TRUE, no.space = TRUE, se=list(NULL))
#Comparing models for coal usage
AIC_armancoaluse<-AIC(armacoaluse)
BIC_armancoaluse<-BIC(armacoaluse)
AIC_coal.mod<-AIC(coal.mod)
BIC_coal.mod<-BIC(coal.mod)
COAL_USAGE_METRICS<-c(AIC_armancoaluse,BIC_armancoaluse,AIC_coal.mod,BIC_coal.mod)
#Comparing models for PPI coal
AIC_arima_ppi_coal<-AIC(arima_ppi_coal)
BIC_arima_ppi_coal<-BIC(arima_ppi_coal)
AIC_ppi_coal_mod<-AIC(ppi_coal_mod )
BIC_ppi_coal_mod<-BIC(ppi_coal_mod )
PPI_COAL_METRICS<-c(AIC_arima_ppi_coal,BIC_arima_ppi_coal,AIC_ppi_coal_mod,BIC_ppi_coal_mod)
#Model selection for PPI natural gas
AIC_ppinatgas2<-AIC(ppinatgas2)
BIC_ppinatgas2<-BIC(ppinatgas2)
AIC_natgas_mod<-AIC(ppi_natgas_mod)
BIC_ppi_nat_mod<-BIC(ppi_natgas_mod)
PPI_NAT_GAS<-c(AIC_ppinatgas2,BIC_ppinatgas2,AIC_natgas_mod,BIC_ppi_nat_mod)
#stargazer(JB.TESTS,title = "BIC and AIC TESTS", header = FALSE, type = "latex", summary = FALSE, rownames = TRUE, colnames = TRUE, no.space = TRUE, se=list(NULL))
# Residual vs fitted forppi natural gas
plot(fitted(ppinatgas2), residuals(ppinatgas2), col="skyblue3", main="Residuals vs Fitted PPI Natural Gas",pch=16)
abline(h=0, col="red")
#very heteroskedastic TRY TO USE GLS Try to trasnf var and then work back ward for trans
################ ppi coal
plot(fitted(arima_ppi_coal), residuals(arima_ppi_coal), col="skyblue3", main="Residuals vs Fitted PPI Coal",pch=16)
abline(h=0,col="red")
#seems to have a structural break actually NO STR BREAK BC CUSUM GOOD
################ usage natural gas
plot(fitted(armanguse), residuals(armanguse), main = 'Residuals vs Fitted Natural Gas Usage',
ylab='Residuals', pch = 16, cex=.5,
xlab='Fitted Values',col="skyblue3")
abline(h=0,col="red")
################ usage coal
plot(fitted(armacoaluse),residuals(armacoaluse), main="Residuals vs Fitted Coal Usage",col="skyblue3", ylab='Residuals',xlab="Fitted Values",pch=16)
abline(h=0,col="red")
#coal usage
plot(acf(coal.mod$residuals, lag.max = 100),main="ACF for")
pacf(coal.mod$residuals, lag.max = 100)
#coal ppi
acf(arima_ppi_coal$residuals, lag.max = 100)
pacf(arima_ppi_coal$residuals, lag.max = 100)
#natural gas usage
acf(armanguse$residuals, lag.max = 100)
pacf(armanguse$residuals, lag.max = 100)
#natural gas ppi
acf(ppinatgas2$residuals, lag.max = 100)
pacf(ppinatgas2$residuals, lag.max = 100)
#CUSUM for coal usage
plot(efp(coal.mod$res~1, type = "Rec-CUSUM"),main="CUSUM coal usage")
#CUSUM for PPI coal
plot(efp(arima_ppi_coal$res~1, type = "Rec-CUSUM"), main="CUSUM PPI coal")
#CUSUM for natural gas usage
plot(efp(armanguse$res~1, type = "Rec-CUSUM"),main="CUSUM natural gas usage")
#CUSUM for PPI natural gas
#quartz()
plot(efp(ppinatgas2$res~1, type = "Rec-CUSUM"),main="CUSUM PPI natural gas")
#Structural break yes it's gonna be a issue for forecast
res_ppi_ng=recresid(ppinatgas2$res~1,col="skyblue3")
plot(res_ppi_ng, pch=16,ylab="Recursive Residuals", main="Recursive Residuals PPI natural gas",col="skyblue3")
abline(h=0, col="red")
res_ppi_c=recresid(arima_ppi_coal$res~1)
plot(res_ppi_c, pch=16,ylab="Recursive Residuals",main="Recursive Residuals PPI coal",col="skyblue3")
abline(h=0,col="red")
res_coal_u=recresid(armacoaluse$res~1)
plot(res_coal_u, pch=16,ylab="Recursive Residuals", main="Recursive Residuals Coal Usage",col="skyblue3")
abline(h=0,col="red")#wuuuuuut?hetero? pretty disperse is good can standardize everything and look at the z score >2 nooo
#STANDR ORIGINAL SERIES FINDING Z SCORE SO FIT STAND MODEL and look at residuals
res_ng_u=recresid(armanguse$res~1)
plot(res_ng_u, pch=16,ylab="Recursive Residuals", main="Recursive Residuals Natural Gas Usage",col="skyblue3")
abline(h=0,col="red")
Box.test(ts.natgas.use, lag = 1, type = "Box-Pierce", fitdf = 0)
Box.test(ts.natgas.use, lag = 1, type = "Ljung-Box", fitdf = 0)
Box.test(ts.coal.use, lag = 1, type = "Box-Pierce", fitdf = 0)
Box.test(ts.coal.use, lag = 1, type = "Ljung-Box", fitdf = 0)
Box.test(ppi.natgas, lag = 1, type = "Box-Pierce", fitdf = 0)
Box.test(ppi.natgas, lag = 1, type = "Ljung-Box", fitdf = 0)
Box.test(ppi.coal, lag = 1, type = "Box-Pierce", fitdf = 0)
Box.test(ppi.coal, lag = 1, type = "Ljung-Box", fitdf = 0)
#is this what she asking for? MAPE ERROR METRICS ETC
forecast(armacoaluse,h=12)
forecast(arima_ppi_coal,h=12)
forecast(armanguse,h=12)
forecast(ppinatgas2,h=12)
plot(forecast(armacoaluse,h=12))
plot(forecast(arima_ppi_coal,h=12))
plot(forecast(armanguse,h=12))
plot(forecast(ppinatgas2,h=12))
## VAR MODEL
#create combined data set
usage_combined = cbind(ts.coal.use,ts.natgas.use)
#create a model selection process
select = VARselect(usage_combined, lag.max = 12, type = c("const", "trend", "both", "none"),
season = NULL, exogen = NULL)
vm = VAR(usage_combined,p=select$selection[1])
plot(vm)
plot(vm)
knitr::opts_chunk$set(echo = TRUE)
library('vars')
library('readxl')
library('Quandl')
library('tseries')
library("forecast")
library("quantmod")
library("xts")
library("tis")
library("moments")
library('stats')
library("strucchange")
#importing data for coal and natural gas usage
xd <- read.csv('https://ljpi.github.io/Net_generation_for_all_sectors_monthly.csv', header = TRUE, skip = 4)
xd[,1] #dates show that data is in reverse order. The first date is Jan 2001 which appears last, and the last date in the ts is Nov 2016
coal_mwh <- rev(xd[,3])
natgas_mwh <- rev(xd[,4])
total_mwh <- rev(xd[,2])
head(xd[,1])
xd[c(1,length(xd[,1])),1]  #We will use Monthly from Jan-01 to Nov-16
ts.coal.use<- ts(coal_mwh, start = c(2001,2), end = c(2016,11), frequency = 12)
ts.natgas.use<- ts(natgas_mwh, start = c(2001,2), end = c(2016, 11), frequency = 12)
length(ts.natgas.use)
length(ts.coal.use)
mape <- function(y, yhat){
mean(abs((y - yhat)/y))
}
#Natural Gas and Coal PPI
getSymbols(c('WPU0531','WPU051'), src = 'FRED')
ppi.natgas <- ts(WPU0531['2001-01-01::2016-11-01'], start = 2001, frequency = 12)
ppi.coal <- ts(WPU051['2001-01-01::2016-11-01'], start = 2001, frequency = 12)
#we make the ppis covariance stationary
diff_coal_ppi<-diff(ppi.coal)
diff_ppinatgas<-diff(ppi.natgas)
plot(diff_ppinatgas, col = 'green', main = "Energy Price Indeces", ylab = "Index, 1982 = 100")
lines(diff_coal_ppi, col = 'orange')
legend('topright', legend = c( 'PPI Coal', 'PPI Natural Gas'), lty = c(1,1), col = c('orange','green'))
#creatime time var
timex<-seq(2001.1,2016.9, by = 1/12)
par(mfrow=c(1,1))
#plot(timex,ts.natgas.use, xlim = c(2001, 2017),
#     ylim = c(0, max(ts.total.use)), ylab = "Megawatthours (thousands)",
#     main = 'General Energy Usage',col="green", type="l",lwd=2)
#lines(timex,ts.coal.use, col = 'orange', lwd = 2)
#legend('topright', legend = c( "Natural Gas Usage",'Coal Usage'), lty = c(1,1), col = c("green",'orange'))
#change the axis
#make time var for x axis using seq()
#check length
#natural gas#
par(mfrow=c(2,1))
plot(acf(ts.natgas.use, lag.max = 100), main="Natural Gas Usage") # Obvious Seasonality. #Peaks at 12 months (winter). Troughs at 6 months (summer).
## VAR MODEL
#create combined data set
usage_combined = cbind(ts.coal.use,ts.natgas.use)
#create a model selection process
select = VARselect(usage_combined, lag.max = 12, type = c("const", "trend", "both", "none"),
season = NULL, exogen = NULL)
vm = VAR(usage_combined,p=select$selection[1])
plot(vm)
## VAR MODEL
#create combined data set
usage_combined = cbind(ts.coal.use,ts.natgas.use)
#create a model selection process
select = VARselect(usage_combined, lag.max = 12, type = c("const", "trend", "both", "none"),
season = NULL, exogen = NULL)
vm = VAR(usage_combined,p=select$selection[1])
plot(vm)
## VAR MODEL
#create combined data set
usage_combined = cbind(ts.coal.use,ts.natgas.use)
#create a model selection process
select = VARselect(usage_combined, lag.max = 12, type = c("const", "trend", "both", "none"),
season = NULL, exogen = NULL)
vm = VAR(usage_combined,p=select$selection[1])
plot(vm)
## VAR MODEL
#create combined data set
usage_combined = cbind(ts.coal.use,ts.natgas.use)
#create a model selection process
select = VARselect(usage_combined, lag.max = 12, type = c("const", "trend", "both", "none"),
season = NULL, exogen = NULL)
vm = VAR(usage_combined,p=select$selection[1])
plot(vm)
knitr::opts_chunk$set(echo = TRUE)
library('vars')
library('readxl')
library('Quandl')
library('tseries')
library("forecast")
library("quantmod")
library("xts")
library("tis")
library("moments")
library('stats')
library("strucchange")
#importing data for coal and natural gas usage
xd <- read.csv('https://ljpi.github.io/Net_generation_for_all_sectors_monthly.csv', header = TRUE, skip = 4)
xd[,1] #dates show that data is in reverse order. The first date is Jan 2001 which appears last, and the last date in the ts is Nov 2016
coal_mwh <- rev(xd[,3])
natgas_mwh <- rev(xd[,4])
total_mwh <- rev(xd[,2])
head(xd[,1])
xd[c(1,length(xd[,1])),1]  #We will use Monthly from Jan-01 to Nov-16
ts.coal.use<- ts(coal_mwh, start = c(2001,2), end = c(2016,11), frequency = 12)
ts.natgas.use<- ts(natgas_mwh, start = c(2001,2), end = c(2016, 11), frequency = 12)
length(ts.natgas.use)
length(ts.coal.use)
mape <- function(y, yhat){
mean(abs((y - yhat)/y))
}
#Natural Gas and Coal PPI
getSymbols(c('WPU0531','WPU051'), src = 'FRED')
ppi.natgas <- ts(WPU0531['2001-01-01::2016-11-01'], start = 2001, frequency = 12)
ppi.coal <- ts(WPU051['2001-01-01::2016-11-01'], start = 2001, frequency = 12)
#we make the ppis covariance stationary
diff_coal_ppi<-diff(ppi.coal)
diff_ppinatgas<-diff(ppi.natgas)
plot(diff_ppinatgas, col = 'green', main = "Energy Price Indeces", ylab = "Index, 1982 = 100")
lines(diff_coal_ppi, col = 'orange')
legend('topright', legend = c( 'PPI Coal', 'PPI Natural Gas'), lty = c(1,1), col = c('orange','green'))
#creatime time var
timex<-seq(2001.1,2016.9, by = 1/12)
par(mfrow=c(1,1))
#plot(timex,ts.natgas.use, xlim = c(2001, 2017),
#     ylim = c(0, max(ts.total.use)), ylab = "Megawatthours (thousands)",
#     main = 'General Energy Usage',col="green", type="l",lwd=2)
#lines(timex,ts.coal.use, col = 'orange', lwd = 2)
#legend('topright', legend = c( "Natural Gas Usage",'Coal Usage'), lty = c(1,1), col = c("green",'orange'))
#change the axis
#make time var for x axis using seq()
#check length
#natural gas#
par(mfrow=c(2,1))
plot(acf(ts.natgas.use, lag.max = 100), main="Natural Gas Usage") # Obvious Seasonality. #Peaks at 12 months (winter). Troughs at 6 months (summer).
knitr::opts_chunk$set(echo = TRUE)
library('vars')
library('readxl')
library('Quandl')
library('tseries')
library("forecast")
library("quantmod")
library("xts")
library("tis")
library("moments")
library('stats')
library("strucchange")
#importing data for coal and natural gas usage
xd <- read.csv('https://ljpi.github.io/Net_generation_for_all_sectors_monthly.csv', header = TRUE, skip = 4)
xd[,1] #dates show that data is in reverse order. The first date is Jan 2001 which appears last, and the last date in the ts is Nov 2016
coal_mwh <- rev(xd[,3])
natgas_mwh <- rev(xd[,4])
total_mwh <- rev(xd[,2])
head(xd[,1])
xd[c(1,length(xd[,1])),1]  #We will use Monthly from Jan-01 to Nov-16
ts.coal.use<- ts(coal_mwh, start = c(2001,2), end = c(2016,11), frequency = 12)
ts.natgas.use<- ts(natgas_mwh, start = c(2001,2), end = c(2016, 11), frequency = 12)
length(ts.natgas.use)
length(ts.coal.use)
mape <- function(y, yhat){
mean(abs((y - yhat)/y))
}
#Natural Gas and Coal PPI
getSymbols(c('WPU0531','WPU051'), src = 'FRED')
ppi.natgas <- ts(WPU0531['2001-01-01::2016-11-01'], start = 2001, frequency = 12)
ppi.coal <- ts(WPU051['2001-01-01::2016-11-01'], start = 2001, frequency = 12)
#we make the ppis covariance stationary
diff_coal_ppi<-diff(ppi.coal)
diff_ppinatgas<-diff(ppi.natgas)
plot(diff_ppinatgas, col = 'green', main = "Energy Price Indeces", ylab = "Index, 1982 = 100")
lines(diff_coal_ppi, col = 'orange')
legend('topright', legend = c( 'PPI Coal', 'PPI Natural Gas'), lty = c(1,1), col = c('orange','green'))
#creatime time var
timex<-seq(2001.1,2016.9, by = 1/12)
par(mfrow=c(1,1))
#plot(timex,ts.natgas.use, xlim = c(2001, 2017),
#     ylim = c(0, max(ts.total.use)), ylab = "Megawatthours (thousands)",
#     main = 'General Energy Usage',col="green", type="l",lwd=2)
#lines(timex,ts.coal.use, col = 'orange', lwd = 2)
#legend('topright', legend = c( "Natural Gas Usage",'Coal Usage'), lty = c(1,1), col = c("green",'orange'))
#change the axis
#make time var for x axis using seq()
#check length
#natural gas#
par(mfrow=c(2,1))
plot(acf(ts.natgas.use, lag.max = 100), main="Natural Gas Usage") # Obvious Seasonality. #Peaks at 12 months (winter). Troughs at 6 months (summer).
knitr::opts_chunk$set(echo = TRUE)
library('vars')
library('readxl')
library('Quandl')
library('tseries')
library("forecast")
library("quantmod")
library("xts")
library("tis")
library("moments")
library('stats')
library("strucchange")
#importing data for coal and natural gas usage
xd <- read.csv('https://ljpi.github.io/Net_generation_for_all_sectors_monthly.csv', header = TRUE, skip = 4)
xd[,1] #dates show that data is in reverse order. The first date is Jan 2001 which appears last, and the last date in the ts is Nov 2016
coal_mwh <- rev(xd[,3])
natgas_mwh <- rev(xd[,4])
total_mwh <- rev(xd[,2])
head(xd[,1])
xd[c(1,length(xd[,1])),1]  #We will use Monthly from Jan-01 to Nov-16
ts.coal.use<- ts(coal_mwh, start = c(2001,2), end = c(2016,11), frequency = 12)
ts.natgas.use<- ts(natgas_mwh, start = c(2001,2), end = c(2016, 11), frequency = 12)
length(ts.natgas.use)
length(ts.coal.use)
mape <- function(y, yhat){
mean(abs((y - yhat)/y))
}
#Natural Gas and Coal PPI
getSymbols(c('WPU0531','WPU051'), src = 'FRED')
ppi.natgas <- ts(WPU0531['2001-01-01::2016-11-01'], start = 2001, frequency = 12)
ppi.coal <- ts(WPU051['2001-01-01::2016-11-01'], start = 2001, frequency = 12)
#we make the ppis covariance stationary
diff_coal_ppi<-diff(ppi.coal)
diff_ppinatgas<-diff(ppi.natgas)
plot(diff_ppinatgas, col = 'green', main = "Energy Price Indeces", ylab = "Index, 1982 = 100")
lines(diff_coal_ppi, col = 'orange')
legend('topright', legend = c( 'PPI Coal', 'PPI Natural Gas'), lty = c(1,1), col = c('orange','green'))
#creatime time var
timex<-seq(2001.1,2016.9, by = 1/12)
par(mfrow=c(1,1))
#plot(timex,ts.natgas.use, xlim = c(2001, 2017),
#     ylim = c(0, max(ts.total.use)), ylab = "Megawatthours (thousands)",
#     main = 'General Energy Usage',col="green", type="l",lwd=2)
#lines(timex,ts.coal.use, col = 'orange', lwd = 2)
#legend('topright', legend = c( "Natural Gas Usage",'Coal Usage'), lty = c(1,1), col = c("green",'orange'))
#change the axis
#make time var for x axis using seq()
#check length
#natural gas#
par(mfrow=c(2,1))
plot(acf(ts.natgas.use, lag.max = 100), main="Natural Gas Usage") # Obvious Seasonality. #Peaks at 12 months (winter). Troughs at 6 months (summer).
#natural gas#
par(mfrow=c(2,1))
acf(ts.natgas.use, lag.max = 100, main="Natural Gas Usage") # Obvious Seasonality. #Peaks at 12 months (winter). Troughs at 6 months (summer).
